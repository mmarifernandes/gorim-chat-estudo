import nltk
from nltk.corpus import stopwords
from nltk.probability import FreqDist
from wordcloud import WordCloud
import string 
import pandas as pd

df = pd.read_csv('logs.csv')

df = df.drop('id', axis=1)
df = df.drop('chat_id', axis=1)
df = df.drop('recipient_id', axis=1)
df = df.drop('recipient_name', axis=1)
df = df.drop('sender_id', axis=1)
df = df.drop('sender_name', axis=1)
df = df.drop('status', axis=1)
df = df.drop('timestamp', axis=1)


df.to_csv('output_file.csv', index=False)

teste = 'oi oi oi oi tudo bem ? quais sementes você gostaria de comprar? uai, gostaria de comprar sementes de arroz, sô! alou me vende os fertilizantes aí na humilda vou fazer o orçamento opa qual a quantidade? 1 a 6 fiz aqui foi ai? acho que não IODHAWIDHOAOH 5 Oi, gostaria de comprar 6 unidades de soja tá querendo me dar calote é? coloquei os 3 que me pediu mas não apareceu o finalizar jogada foi enviado nas 3 parcelas comprado tem algum desconto? ahh acho que foi sim mas tem que finalizar a rodada então ficou verdinho aqui faz orçamento para mim, sô! 5 Máquinas 2 não está aparecendo aqui pra finalizar psé Gostaria de 5 de A.Premium, sô! Eai mestre, tudo bom? Fiz minha jogada mas não está aparecendo para finalizar a rodada oi sim, posso fazer com o custo medio tá bem, vou querer nao sei oque fazer vou fazer o orçamento e você quiser mais algum orçamento, pode entrar em contato omigo comigo Oi, gostaria de comprar 6 unidades de fertilizante o orçamento já foi enviado faz o orçamento de 5 fertilizantes comuns para mim, sô quando terminar é só me avisar! pra poder ir para a proxima etapa quando terminar é só me avisar! pra poder ir para a proxima etapa gostaria de mais algum orçamento? quando terminar é só me avisar! pra poder ir para a proxima etapa posso te ajudar em mais alguma coisa? quando terminar é só me avisar! pra poder ir para a proxima etapa opa quando terminar é só me avisar! pra poder ir para a proxima etapa oi, tudo certo, fiz aqui pra você ainda não consigo vender está bem certo, estamos aguardando os outros que eu quero fazer um negócio batuta deu está bem! Obrigada obrigada, nossa empresa agradece o retorno feito! mandei prra uma pessoa nossa empresa agradece o retorno um orçamento mando mais? eu que agradeço, estamos a disposição três orçamentos feitos tudo pronto podes mandar quantos quiseres!! o ideal é ver quantos a pessoa precisa Oi, gostaria de comprar 6 unidades de agrotóxico tá bom, voltarei na próxima okay na verdade eu acho que vc não compra cmg não ah não pera descurpa, já tinha comprado não me alembrava vê se foi oi quantas maquias prescisas? ok AHSUUHAHSHUAHUS mas não recebi nenhum dinheiros caloteiro foi por enquanto não uai na próxima semana eu tento plantar soja quer casar na roça  com eu? o chat nao tem notificação? já terminei deus lhe pague aparece uma bolinha ali do lado do nome de qm mandou mensagem vai receber um processo vc zerdinha apareceu aqui certo!! estamos aguardando os outros otimo foi, realizei a compra progresso? deus lhe ouça, sô pensei q era de online quero sim uai descurpa, fiz só o jardim de infância mas reprovei 4 vezes por causa de que me cortava com a tesoura uai oi, não vou conseguir investir em máquinas agora tudo certo? fica para próxima ok carai, não sabia que o chico bento tava aqui como que aprendeu a escrever tão bem assim? certo só passar acomecei a morar em Rio Grande oque seria uma açao ambiental? são ações que tu aplica na cidade para diminuir a poluição da mesma tabom qué comprar selo verde? vendo no precinho pra ti te mandei 100 reais acredito que tenha ido aqui já fiz minhas ações mandei duas sugestões ao prefeito certo, estamos aguardando os demais certo, estamos aguardando os demais acho que seria legal agnt conectar por voz vcs devem ta interagindo ai no lamsa eu to parado olhando pra tela esperando a galera uhum, eu também acho uma boa sugestão, mas a gente ta usando o chat pra testar e tudo mais, o teste feito em 2021 foi todo mundo em chamada mas mutados já terminasse? sim tem que ficar te avisando? sim tabom olá nossa empresa está com uma promoção de natal 3 arroz e 3 de soja, por obséquio faremos desconto  de preço baixo gostei hortaliças? ou arroz e soja? 6 de a.premium, por favor arroz e soja vai sair caro  qual a quantidade desejada? nossa promoção é para hortaliças hortaliças então 6 certo!! mandei comprei vai comprar fertilizante chico? vou ver olá estamos com uma promoção de natal, comprando 6 unidades de hortaliças fazemos o preço baixo uai olá estamos com uma promoção de natal, comprando 6 unidades de hortaliças fazemos o preço baixo 6 do premium agradecemos sua preferência, volte sempre Olá, tudo certo obaa! vou querer volto hoje mais tarde, uai vamo logo, uai tenho que prantar antes do sol se por bom dia tenho otimas maquias a venda! vai um super maquina da super maquinas para voce? feito bom dia tenho otimas maquias a venda! vai um super maquina da super maquinas para voce? feito uai bom dia tenho otimas maquias a venda! vai um super maquina da super maquinas para voce? muito obrigada agradecemos sua preferência, volte sempre ainda tenho maquina aqui, uai, mas ja ja compremo de novo ok, a super maquinas agradece seu retornno! foi te acalma chico a vida não é um morango Bom dia!, o que você teria disponível? aqui foi uai maquinas 1 maquinas 2 maquinas 3 e nosso novissimo pulverizador que coincidência, sô tenho um morangão aqui procê uai que chegou direto da china com os briks okayy, estamos aguardando os outros vai um fertilizante aí cpx Bom dia prefeito! Consigo taxas mais baixas nessa rodada? Bom dia vereador! Consigo taxas mais baixas nessa rodada? sim, gostaria de duas mais em conta agradecemos sua preferência, volte sempre e pra ja me avisem quando estiverem prontos pra proxima etapa me avisem quando estiverem prontos pra proxima etapa claro  me avisem quando estiverem prontos pra proxima etapa feitoria me avisem quando estiverem prontos pra proxima etapa me avisem quando estiverem prontos pra proxima etapa qual?? deu e qnts okayy fala logo que não tenho o dia todo muito obrigada kkkkkk está bem 2, do comum pobre eca a super maquinas agradece, a negociação feito Bom dia fiscal? consigo o selo verde contigo? estamos com uma nova promoção de natal, comprando 3 unidades de arroz ou soja fazemos o preço medio. Se comprar 6 unidades o preço é baixo. Abaixo de 3 unidades o preço é alto estamos com uma nova promoção de natal, comprando 3 unidades de arroz ou soja fazemos o preço medio. Se comprar 6 unidades o preço é baixo. Abaixo de 3 unidades o preço é alto estamos com uma nova promoção de natal, comprando 3 unidades de arroz ou soja fazemos o preço medio. Se comprar 6 unidades o preço é baixo. Abaixo de 3 unidades o preço é alto Me tira uma dúvida mestre, algumas dicas para aumentar meu dinheiro? 3 unidades fertilizante?? soja ou arroz? ou um de cada? vou querer na proxiima rodada quanto mais produtividade tu tem mais dinheiro tu ganha na próxima etapa, então dependendo da tua estratégia é bom investir em produtos de qualidade e tals agora vc já me vendeu uai soja, por favor deixa eu prantar primeiro ta bem, agradecemos o retorno feito, agradecemos a preferência Não consigo produzir mais, infelizmente só vi agora aqui foi, tudo pronto para a próxima ta bem mas estamos a disposição sempre certo!! estamos aguardando 2 pessoas ainda oi, a promoção etá muito boa,mas , acabei de fazer meu plantio estou esperando o cd1 retornar foi esta bem pronto oi, hj não, me endividei terminei prontinho ok joquei pronto pra que serve mandar dinheiro? tu pode mandar como favor pras pessoas, do jeito q tu quiser podes emprestar tb entendi se vocÊ fizer promoção de soja, eu te voto pra prefeito votado se vocÊ fizer promoção pra mim de 6 a. super premium voto em ocê pra prefeito, uai opa na hora! feito estamos com uma nova promoção de natal, comprando 3 unidades de arroz ou soja fazemos o preço medio. Se comprar 6 unidades o preço é baixo. Abaixo de 3 unidades o preço é alto" "estamos com uma nova promoção de natal, comprando 3 unidades de arroz ou soja fazemos o preço medio. Se comprar 6 unidades o preço é baixo. Abaixo de 3 unidades o preço é alto" "estamos com uma nova promoção de natal, comprando 3 unidades de arroz ou soja fazemos o preço medio. Se comprar 6 unidades o preço é baixo. Abaixo de 3 unidades o preço é alto se ocê fizer promoção de 6 a. super premium certo!! eu voto em ocê na eleição pra prefeito quero 6 de soja,  uai posso fazer 3 unidades de soja é pra já! agradecemos sua preferência, volte sempre agradecemos sua preferência, volte sempre ocê vendeu premium oi, vou de 6 unidades de soja infelizmente não vou poder votar em ocê, uai agora to no prejuizo agradecemos sua preferência, volte sempre vou poluir 2x mais agora uai o mst vai invadir minha terra obrigada! eu que agradeço me empresta R$ 200 ai para eu poder refazer a colheita, uai pronto infelizmente tb estou em tempos dificeis sô nunca vi 200 reais na vida.... faz tempo ;( posso te mandar 100 e você vota em mim, q tal? :)o as terra, uai pode ser aceito feito :D okayy opa 2 fertilizantes premium tem ai? feito aqui lógico no precinho valleu meu voto ocê já tem já ganhou, uai passa lá em casa mais tarde comer um salame e um queijo me avisem quando estiverem prontos pra proxima etapa me avisem quando estiverem prontos pra proxima etapa me avisem quando estiverem prontos pra proxima etapa me avisem quando estiverem prontos pra proxima etapa fala mestre, o agrotóxico dura só uma rodada ou fica em todas até acabarem? feito dura só uma blz lá ele tá me estranhando  estou disposição a qualquer momento foi tens um toxico do bom ai? me avisem quando estiverem prontos pra proxima etapa estamos a disposição  tenho!! precisa de quantos? a se bem q eh empresário KKKKKK por mim ok, estou esperando aparecer alguma nova proposta mas pode ir para a próxima por mim fiz um orçamento dos bons agora infelizmente não posso essa quantidade só consigo 3 envieii me apareceu isso Você não pode comprar esse produto, pois já tem ou já orçou 6 unidades deste tipo mesmo tendo 3 espaço disponíveis aqui diz que tu já comprou 6 premium mais cedo tá.....ksksks vou passar para a proxima okay? oukay estou aguardando o vereador feito quero saber a sua intenção de jogada quero saber a sua intenção de jogada hm, explique melhor recebi essa mensagem na tela Você não é um dos jogadores eleitos. Converse com o Fiscal, o Prefeito e o Vereador de sua cidade para saber a intenção de jogada deles e espere a rodada terminar para continuar jogando. so segui kkkkkk kkkkkkkkkkkkk não entendi a minha intenção é o progresso!  boa de pois dobrar a meta depois de ser dobrada se saissse um sonzinho quando recebesse mensagem e atualizasse jogada e proposta etc seria bacana desvia um dinheiros para se prefeito! vou asfaltar as rua prometo! desvia um dinheiros para se prefeito! vou asfaltar as rua prometo! pior que seria uma boa msmo!! obg pela sugestao oii me avisa quando terminar bó oii me avisa quando terminar oii me avisa quando terminar oii me avisa quando terminar o discord pingou eu achei que era do gorim kkkkkkk foi assim q me liguei oii me avisa quando terminar ando muito pobre, com dor nas costa mande um dinheiros vc ta conseguindo jogar? pode ir terminei desculpa eai'
teste.replace('"', ' ')
teste.replace(',', ' ')
print(teste)
dados = open('output_file.csv', mode='r', encoding='utf-8').read()
dados = dados.lower()

# teste = dados.split(",")
dados_sem_ponto = ''.join([p for p in dados if p not in string.punctuation])
# teste = dados_sem_ponto.split("\n")
# print(dados_sem_ponto)
tokenizacao_dados = nltk.word_tokenize(dados_sem_ponto) #separa em array palavras
tokenizacao_dados.pop(0)

nltk.download('stopwords')
stopwords = stopwords.words('portuguese')
palavras_sem_stop = [p for p in tokenizacao_dados if p not in stopwords]

freq = FreqDist(palavras_sem_stop)
freq = freq.most_common(10)
# print(freq)


nuvem = WordCloud(
    background_color='white',
    stopwords=stopwords,
    height=1080,
    width = 1080,
    max_words=100
)

nuvem.generate(dados)
nuvem.to_file('nuvem.png')